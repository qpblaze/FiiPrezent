@using FiiPrezent.Models
@model EventViewModel

@{
    ViewBag.Title = "Event";
    Layout = "_Layout";
}

<h2>@Model.Name</h2>
<span>@Model.Description</span>

<ol id="participants">
    @foreach (var p in Model.Participants)
    {
        <li>@p</li>
    }
</ol>


@section Scripts
{
    <script>
        var eventId = window.location.pathname.substring(window.location.pathname.lastIndexOf("/") + 1);
        var participantsList = document.getElementById("participants");
        var connection = new signalR.HubConnection("/participants?eventId=" + eventId);

        function appendParticipant(name) {
            var li = document.createElement("li");
            li.innerText = name;
            participantsList.appendChild(li);
        }

        connection.on('Update', (list) => {
            participantsList.innerHTML = "";
            list.forEach(function (el) {
                appendParticipant(el);
            });
        });

        connection.start();
    </script>
}
